webpackHotUpdate("static/development/pages/index.js",{

/***/ "./common/state.js":
/*!*************************!*\
  !*** ./common/state.js ***!
  \*************************/
/*! exports provided: sourceSelect, sourceSwap, sectionSelect, sectionClear, sectionCount, update, openBrowser, openSimulator, setHostType, setBuildFlags, sendProjectUrl, updateProjectConfig, publishProject, updateLastRead, clearMessages */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "sourceSelect", function() { return sourceSelect; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "sourceSwap", function() { return sourceSwap; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "sectionSelect", function() { return sectionSelect; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "sectionClear", function() { return sectionClear; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "sectionCount", function() { return sectionCount; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "update", function() { return update; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "openBrowser", function() { return openBrowser; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "openSimulator", function() { return openSimulator; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "setHostType", function() { return setHostType; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "setBuildFlags", function() { return setBuildFlags; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "sendProjectUrl", function() { return sendProjectUrl; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "updateProjectConfig", function() { return updateProjectConfig; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "publishProject", function() { return publishProject; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "updateLastRead", function() { return updateLastRead; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "clearMessages", function() { return clearMessages; });
/* harmony import */ var _babel_runtime_corejs2_regenerator__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @babel/runtime-corejs2/regenerator */ "../../node_modules/@babel/runtime-corejs2/regenerator/index.js");
/* harmony import */ var _babel_runtime_corejs2_regenerator__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(_babel_runtime_corejs2_regenerator__WEBPACK_IMPORTED_MODULE_0__);
/* harmony import */ var _babel_runtime_corejs2_helpers_esm_asyncToGenerator__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @babel/runtime-corejs2/helpers/esm/asyncToGenerator */ "../../node_modules/@babel/runtime-corejs2/helpers/esm/asyncToGenerator.js");
/* harmony import */ var _babel_runtime_corejs2_helpers_esm_objectSpread__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @babel/runtime-corejs2/helpers/esm/objectSpread */ "../../node_modules/@babel/runtime-corejs2/helpers/esm/objectSpread.js");
/* harmony import */ var _babel_runtime_corejs2_helpers_esm_taggedTemplateLiteral__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @babel/runtime-corejs2/helpers/esm/taggedTemplateLiteral */ "../../node_modules/@babel/runtime-corejs2/helpers/esm/taggedTemplateLiteral.js");
/* harmony import */ var _babel_runtime_corejs2_helpers_esm_toConsumableArray__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! @babel/runtime-corejs2/helpers/esm/toConsumableArray */ "../../node_modules/@babel/runtime-corejs2/helpers/esm/toConsumableArray.js");
/* harmony import */ var _babel_runtime_corejs2_core_js_promise__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! @babel/runtime-corejs2/core-js/promise */ "../../node_modules/@babel/runtime-corejs2/core-js/promise.js");
/* harmony import */ var _babel_runtime_corejs2_core_js_promise__WEBPACK_IMPORTED_MODULE_5___default = /*#__PURE__*/__webpack_require__.n(_babel_runtime_corejs2_core_js_promise__WEBPACK_IMPORTED_MODULE_5__);
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! react */ "../../node_modules/react/index.js");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_6___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_6__);
/* harmony import */ var graphql_tag__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! graphql-tag */ "../../node_modules/graphql-tag/src/index.js");
/* harmony import */ var graphql_tag__WEBPACK_IMPORTED_MODULE_7___default = /*#__PURE__*/__webpack_require__.n(graphql_tag__WEBPACK_IMPORTED_MODULE_7__);
/* harmony import */ var lodash_uniqBy__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! lodash/uniqBy */ "../../node_modules/lodash/uniqBy.js");
/* harmony import */ var lodash_uniqBy__WEBPACK_IMPORTED_MODULE_8___default = /*#__PURE__*/__webpack_require__.n(lodash_uniqBy__WEBPACK_IMPORTED_MODULE_8__);
/* harmony import */ var lodash_fp_set__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! lodash/fp/set */ "../../node_modules/lodash/fp/set.js");
/* harmony import */ var lodash_fp_set__WEBPACK_IMPORTED_MODULE_9___default = /*#__PURE__*/__webpack_require__.n(lodash_fp_set__WEBPACK_IMPORTED_MODULE_9__);
/* harmony import */ var apollo_client__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! apollo-client */ "../../node_modules/apollo-client/bundle.esm.js");
/* harmony import */ var _sets__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! ./sets */ "./common/sets.js");






var _jsxFileName = "/Users/ville/Projects/expo-cli/packages/dev-tools/common/state.js";

function _templateObject12() {
  var data = Object(_babel_runtime_corejs2_helpers_esm_taggedTemplateLiteral__WEBPACK_IMPORTED_MODULE_3__["default"])(["\n      mutation ClearMessages($sourceId: ID!) {\n        clearMessages(sourceId: $sourceId) {\n          id\n          messages {\n            count\n            unreadCount\n          }\n        }\n      }\n    "]);

  _templateObject12 = function _templateObject12() {
    return data;
  };

  return data;
}

function _templateObject11() {
  var data = Object(_babel_runtime_corejs2_helpers_esm_taggedTemplateLiteral__WEBPACK_IMPORTED_MODULE_3__["default"])(["\n  mutation UpdateLastread($sourceId: ID!, $lastReadCursor: String!) {\n    updateLastRead(sourceId: $sourceId, lastReadCursor: $lastReadCursor) {\n      id\n      messages {\n        unreadCount\n        pageInfo {\n          lastReadCursor\n        }\n      }\n    }\n  }\n"]);

  _templateObject11 = function _templateObject11() {
    return data;
  };

  return data;
}

function _templateObject10() {
  var data = Object(_babel_runtime_corejs2_helpers_esm_taggedTemplateLiteral__WEBPACK_IMPORTED_MODULE_3__["default"])(["\n        mutation PublishProject {\n          publishProject {\n            url\n          }\n        }\n      "]);

  _templateObject10 = function _templateObject10() {
    return data;
  };

  return data;
}

function _templateObject9() {
  var data = Object(_babel_runtime_corejs2_helpers_esm_taggedTemplateLiteral__WEBPACK_IMPORTED_MODULE_3__["default"])(["\n        mutation OptimizeAssets {\n          optimizeAssets {\n            projectDir\n          }\n        }\n      "]);

  _templateObject9 = function _templateObject9() {
    return data;
  };

  return data;
}

function _templateObject8() {
  var data = Object(_babel_runtime_corejs2_helpers_esm_taggedTemplateLiteral__WEBPACK_IMPORTED_MODULE_3__["default"])(["\n      mutation SetProjectConfig($input: ProjectConfigInput!) {\n        setProjectConfig(input: $input) {\n          id\n          config {\n            name\n            description\n            slug\n            githubUrl\n          }\n        }\n      }\n    "]);

  _templateObject8 = function _templateObject8() {
    return data;
  };

  return data;
}

function _templateObject7() {
  var data = Object(_babel_runtime_corejs2_helpers_esm_taggedTemplateLiteral__WEBPACK_IMPORTED_MODULE_3__["default"])(["\n        mutation SendProjectUrl($recipient: String!) {\n          sendProjectUrl(recipient: $recipient) {\n            medium\n          }\n        }\n      "]);

  _templateObject7 = function _templateObject7() {
    return data;
  };

  return data;
}

function _templateObject6() {
  var data = Object(_babel_runtime_corejs2_helpers_esm_taggedTemplateLiteral__WEBPACK_IMPORTED_MODULE_3__["default"])(["\n      mutation SetBuildFlags($dev: Boolean!, $minify: Boolean!) {\n        setProjectSettings(settings: { dev: $dev, minify: $minify }) {\n          id\n          settings {\n            dev\n            minify\n          }\n        }\n      }\n    "]);

  _templateObject6 = function _templateObject6() {
    return data;
  };

  return data;
}

function _templateObject5() {
  var data = Object(_babel_runtime_corejs2_helpers_esm_taggedTemplateLiteral__WEBPACK_IMPORTED_MODULE_3__["default"])(["\n      mutation SetHostType($hostType: HostType!) {\n        setProjectSettings(settings: { hostType: $hostType }) {\n          id\n          manifestUrl\n          settings {\n            hostType\n          }\n        }\n      }\n    "]);

  _templateObject5 = function _templateObject5() {
    return data;
  };

  return data;
}

function _templateObject4() {
  var data = Object(_babel_runtime_corejs2_helpers_esm_taggedTemplateLiteral__WEBPACK_IMPORTED_MODULE_3__["default"])(["\n        mutation OpenSimulator($platform: Platform!) {\n          openSimulator(platform: $platform) {\n            __typename\n          }\n        }\n      "]);

  _templateObject4 = function _templateObject4() {
    return data;
  };

  return data;
}

function _templateObject3() {
  var data = Object(_babel_runtime_corejs2_helpers_esm_taggedTemplateLiteral__WEBPACK_IMPORTED_MODULE_3__["default"])(["\n        mutation OpenWeb {\n          openWeb {\n            error\n          }\n        }\n      "]);

  _templateObject3 = function _templateObject3() {
    return data;
  };

  return data;
}

function _templateObject2() {
  var data = Object(_babel_runtime_corejs2_helpers_esm_taggedTemplateLiteral__WEBPACK_IMPORTED_MODULE_3__["default"])(["\n                fragment SelectedSource on Source {\n                  __typename\n                  id\n                }\n              "]);

  _templateObject2 = function _templateObject2() {
    return data;
  };

  return data;
}

function _templateObject() {
  var data = Object(_babel_runtime_corejs2_helpers_esm_taggedTemplateLiteral__WEBPACK_IMPORTED_MODULE_3__["default"])(["\n  mutation UpdateProjectManagerLayout($input: ProjectManagerLayoutInput!) {\n    setProjectManagerLayout(input: $input) {\n      id\n      selected {\n        id\n      }\n      sources {\n        id\n        messages {\n          unreadCount\n        }\n      }\n    }\n  }\n"]);

  _templateObject = function _templateObject() {
    return data;
  };

  return data;
}








var delay = function delay(time) {
  return new _babel_runtime_corejs2_core_js_promise__WEBPACK_IMPORTED_MODULE_5___default.a(function (resolve) {
    return window.setTimeout(resolve, time);
  });
};

var sourceSelect = function sourceSelect(source, props) {
  var layout = props.data.projectManagerLayout;
  var existingIndex = layout.sources.findIndex(function (s) {
    return s.id === source.id;
  });
  var selected = source.id;
  var sources;

  if (existingIndex >= 0) {
    // If source is already shown, only select it.
    sources = layout.sources;
  } else {
    var selectedIndex = layout.sources.findIndex(function (s) {
      return layout.selected && s.id === layout.selected.id;
    }); // Replace the source in the selected panel.
    // If selectedIndex is -1 (no panel selected), set the first item.

    sources = lodash_fp_set__WEBPACK_IMPORTED_MODULE_9___default()(Math.max(selectedIndex, 0), source, layout.sources);
  } // NOTE(jim): Breaks out of publishing modal.


  props.dispatch({
    type: 'UPDATE',
    state: {
      isPublishing: false
    }
  });
  return updateLayout(props.client, layout.id, {
    selected: selected,
    sources: sources
  });
};
var sourceSwap = function sourceSwap(_ref, props) {
  var targetSourceId = _ref.targetSourceId,
      movedSourceId = _ref.movedSourceId;
  var _props$data = props.data,
      layout = _props$data.projectManagerLayout,
      currentProject = _props$data.currentProject;
  var targetIndex = layout.sources.findIndex(function (source) {
    return source.id === targetSourceId;
  });
  var movedIndex = layout.sources.findIndex(function (source) {
    return source.id === movedSourceId;
  });
  var sources;

  if (movedIndex === -1) {
    var newSource = currentProject.sources.find(function (source) {
      return source.id === movedSourceId;
    });
    sources = lodash_fp_set__WEBPACK_IMPORTED_MODULE_9___default()(targetIndex, newSource, layout.sources);
  } else {
    sources = _sets__WEBPACK_IMPORTED_MODULE_11__["swap"](layout.sources, targetIndex, movedIndex);
  }

  return updateLayout(props.client, layout.id, {
    selected: layout.selected ? layout.selected.id : null,
    sources: sources
  });
};
var sectionSelect = function sectionSelect(_ref2, props) {
  var id = _ref2.id;
  var layout = props.data.projectManagerLayout;
  var layoutInput = {
    selected: id,
    sources: layout.sources
  };
  return updateLayout(props.client, layout.id, layoutInput);
};
var sectionClear = function sectionClear(props) {
  var layout = props.data.projectManagerLayout;
  var layoutInput = {
    selected: null,
    sources: layout.sources
  };
  return updateLayout(props.client, layout.id, layoutInput);
};
var sectionCount = function sectionCount(_ref3, props) {
  var count = _ref3.count;
  var _props$data2 = props.data,
      layout = _props$data2.projectManagerLayout,
      currentProject = _props$data2.currentProject;
  var sources = currentProject.sources.filter(function (source) {
    return source.__typename !== 'Issues' || source.messages.count > 0;
  });
  var newSources;

  if (count > layout.sources.length) {
    newSources = lodash_uniqBy__WEBPACK_IMPORTED_MODULE_8___default()([].concat(Object(_babel_runtime_corejs2_helpers_esm_toConsumableArray__WEBPACK_IMPORTED_MODULE_4__["default"])(layout.sources), Object(_babel_runtime_corejs2_helpers_esm_toConsumableArray__WEBPACK_IMPORTED_MODULE_4__["default"])(sources)), function (source) {
      return source.id;
    }).slice(0, count);
  } else {
    newSources = layout.sources.slice(0, count);
  }

  var selected;

  if (layout.selected && newSources.some(function (source) {
    return source.id === layout.selected.id;
  })) {
    selected = layout.selected.id;
  } else {
    selected = null;
  }

  var layoutInput = {
    selected: selected,
    sources: newSources
  }; // NOTE(jim): Breaks out of publishing modal.

  props.dispatch({
    type: 'UPDATE',
    state: {
      isPublishing: false
    }
  });
  return updateLayout(props.client, layout.id, layoutInput);
};
var update = function update(state, props) {
  props.dispatch({
    type: 'UPDATE',
    state: state
  });
};
var UPDATE_PROJECT_MANAGER_QUERY = graphql_tag__WEBPACK_IMPORTED_MODULE_7___default()(_templateObject());

function updateLayout(client, id, input) {
  return client.mutate({
    mutation: UPDATE_PROJECT_MANAGER_QUERY,
    variables: {
      input: {
        selected: input.selected,
        sources: input.sources.map(function (source) {
          return source.id;
        })
      }
    },
    optimisticResponse: {
      __typename: 'Mutation',
      setProjectManagerLayout: {
        __typename: 'ProjectManagerLayout',
        id: id,
        selected: input.selected ? client.readFragment({
          id: input.selected,
          fragment: graphql_tag__WEBPACK_IMPORTED_MODULE_7___default()(_templateObject2())
        }) : null,
        sources: input.sources.map(function (source) {
          return Object(_babel_runtime_corejs2_helpers_esm_objectSpread__WEBPACK_IMPORTED_MODULE_2__["default"])({}, source, {
            messages: {
              __typename: 'MessageConnection',
              unreadCount: 0
            }
          });
        })
      }
    }
  });
}

var openBrowser = /*#__PURE__*/function () {
  var _ref4 = Object(_babel_runtime_corejs2_helpers_esm_asyncToGenerator__WEBPACK_IMPORTED_MODULE_1__["default"])( /*#__PURE__*/_babel_runtime_corejs2_regenerator__WEBPACK_IMPORTED_MODULE_0___default.a.mark(function _callee(props) {
    var id, hasError, result;
    return _babel_runtime_corejs2_regenerator__WEBPACK_IMPORTED_MODULE_0___default.a.wrap(function _callee$(_context) {
      while (1) {
        switch (_context.prev = _context.next) {
          case 0:
            id = new Date().getTime(); // NOTE(jim): Breaks out of publishing modal.

            props.dispatch({
              type: 'UPDATE',
              state: {
                isPublishing: false
              }
            });
            props.dispatch({
              type: 'ADD_TOAST',
              toast: {
                id: id,
                name: 'info',
                text: "Attempting to open the project in a web browser..."
              }
            });
            hasError = false;
            _context.prev = 4;
            _context.next = 7;
            return props.client.mutate({
              mutation: graphql_tag__WEBPACK_IMPORTED_MODULE_7___default()(_templateObject3()),
              variables: {}
            });

          case 7:
            result = _context.sent;

            if (result.data.openWeb.error) {
              hasError = true;
            }

            _context.next = 14;
            break;

          case 11:
            _context.prev = 11;
            _context.t0 = _context["catch"](4);
            hasError = true;

          case 14:
            if (!hasError) {
              props.dispatch({
                type: 'REMOVE_TOAST',
                id: id
              });
            } else {
              props.dispatch({
                type: 'ADD_TOAST',
                toast: {
                  id: id,
                  name: 'error',
                  text: "Error opening for web. Check logs for details."
                }
              });
            }

          case 15:
          case "end":
            return _context.stop();
        }
      }
    }, _callee, null, [[4, 11]]);
  }));

  return function openBrowser(_x) {
    return _ref4.apply(this, arguments);
  };
}();
var openSimulator = /*#__PURE__*/function () {
  var _ref5 = Object(_babel_runtime_corejs2_helpers_esm_asyncToGenerator__WEBPACK_IMPORTED_MODULE_1__["default"])( /*#__PURE__*/_babel_runtime_corejs2_regenerator__WEBPACK_IMPORTED_MODULE_0___default.a.mark(function _callee2(platform, props) {
    var id, hasError, result;
    return _babel_runtime_corejs2_regenerator__WEBPACK_IMPORTED_MODULE_0___default.a.wrap(function _callee2$(_context2) {
      while (1) {
        switch (_context2.prev = _context2.next) {
          case 0:
            id = new Date().getTime(); // NOTE(jim): Breaks out of publishing modal.

            props.dispatch({
              type: 'UPDATE',
              state: {
                isPublishing: false
              }
            });
            props.dispatch({
              type: 'ADD_TOAST',
              toast: {
                id: id,
                name: 'info',
                text: "Attempting to open a simulator..."
              }
            });
            hasError = false; // TODO(freiksenet): Add generic error handling

            _context2.prev = 4;
            _context2.next = 7;
            return props.client.mutate({
              mutation: graphql_tag__WEBPACK_IMPORTED_MODULE_7___default()(_templateObject4()),
              variables: {
                platform: platform
              }
            });

          case 7:
            result = _context2.sent;
            hasError = result.data.openSimulator.__typename === 'OpenSimulatorError';
            _context2.next = 14;
            break;

          case 11:
            _context2.prev = 11;
            _context2.t0 = _context2["catch"](4);
            hasError = true;

          case 14:
            if (hasError) {
              _context2.next = 21;
              break;
            }

            props.dispatch({
              type: 'ADD_TOAST',
              toast: {
                id: id,
                name: 'success',
                text: "Simulator ready"
              }
            });
            _context2.next = 18;
            return delay(2000);

          case 18:
            props.dispatch({
              type: 'REMOVE_TOAST',
              id: id
            });
            _context2.next = 22;
            break;

          case 21:
            props.dispatch({
              type: 'ADD_TOAST',
              toast: {
                id: id,
                name: 'error',
                text: "Error opening simulator. Check Metro logs for details."
              }
            });

          case 22:
          case "end":
            return _context2.stop();
        }
      }
    }, _callee2, null, [[4, 11]]);
  }));

  return function openSimulator(_x2, _x3) {
    return _ref5.apply(this, arguments);
  };
}();
var setHostType = function setHostType(_ref6, _ref7) {
  var hostType = _ref6.hostType;
  var client = _ref7.client;
  return client.mutate({
    mutation: graphql_tag__WEBPACK_IMPORTED_MODULE_7___default()(_templateObject5()),
    variables: {
      hostType: hostType
    }
  });
};
var setBuildFlags = function setBuildFlags(_ref8, _ref9) {
  var dev = _ref8.dev,
      minify = _ref8.minify;
  var client = _ref9.client;
  return client.mutate({
    mutation: graphql_tag__WEBPACK_IMPORTED_MODULE_7___default()(_templateObject6()),
    variables: {
      dev: dev,
      minify: minify
    }
  });
};
var sendProjectUrl = /*#__PURE__*/function () {
  var _ref10 = Object(_babel_runtime_corejs2_helpers_esm_asyncToGenerator__WEBPACK_IMPORTED_MODULE_1__["default"])( /*#__PURE__*/_babel_runtime_corejs2_regenerator__WEBPACK_IMPORTED_MODULE_0___default.a.mark(function _callee3(recipient, props) {
    return _babel_runtime_corejs2_regenerator__WEBPACK_IMPORTED_MODULE_0___default.a.wrap(function _callee3$(_context3) {
      while (1) {
        switch (_context3.prev = _context3.next) {
          case 0:
            if (!props.data.user.username) {
              props.dispatch({
                type: 'ADD_TOAST',
                toast: {
                  id: 'authentication-required',
                  name: 'info',
                  text: 'Authentication is required. Please check the terminal to log in.'
                }
              });
            }

            _context3.prev = 1;
            _context3.next = 4;
            return props.client.mutate({
              mutation: graphql_tag__WEBPACK_IMPORTED_MODULE_7___default()(_templateObject7()),
              variables: {
                recipient: recipient
              }
            });

          case 4:
            _context3.next = 14;
            break;

          case 6:
            _context3.prev = 6;
            _context3.t0 = _context3["catch"](1);

            if (!(_context3.t0 instanceof apollo_client__WEBPACK_IMPORTED_MODULE_10__["ApolloError"])) {
              _context3.next = 13;
              break;
            }

            props.dispatch({
              type: 'ADD_TOAST',
              toast: {
                id: 'send-email-or-number',
                name: 'error',
                text: "Oops, sending a link to \"".concat(recipient, "\" failed.")
              }
            });
            return _context3.abrupt("return");

          case 13:
            throw _context3.t0;

          case 14:
            props.dispatch({
              type: 'ADD_TOAST',
              toast: {
                id: 'send-email-or-number',
                name: 'success',
                text: "We sent ".concat(recipient, " a link to open this project.")
              }
            });

          case 15:
          case "end":
            return _context3.stop();
        }
      }
    }, _callee3, null, [[1, 6]]);
  }));

  return function sendProjectUrl(_x4, _x5) {
    return _ref10.apply(this, arguments);
  };
}();
var updateProjectConfig = function updateProjectConfig(config, props) {
  return props.client.mutate({
    mutation: graphql_tag__WEBPACK_IMPORTED_MODULE_7___default()(_templateObject8()),
    variables: {
      input: config
    }
  });
};
var publishProject = /*#__PURE__*/function () {
  var _ref11 = Object(_babel_runtime_corejs2_helpers_esm_asyncToGenerator__WEBPACK_IMPORTED_MODULE_1__["default"])( /*#__PURE__*/_babel_runtime_corejs2_regenerator__WEBPACK_IMPORTED_MODULE_0___default.a.mark(function _callee4(options, props) {
    var publishingId, result, url;
    return _babel_runtime_corejs2_regenerator__WEBPACK_IMPORTED_MODULE_0___default.a.wrap(function _callee4$(_context4) {
      while (1) {
        switch (_context4.prev = _context4.next) {
          case 0:
            publishingId = new Date().getTime();
            props.dispatch({
              type: 'ADD_TOAST',
              toast: {
                id: publishingId,
                name: 'info',
                text: "Publishing..."
              }
            });
            _context4.next = 4;
            return updateProjectConfig(options.config, props);

          case 4:
            update({
              isPublishing: false
            }, props);

            if (!options.optimize) {
              _context4.next = 8;
              break;
            }

            _context4.next = 8;
            return props.client.mutate({
              mutation: graphql_tag__WEBPACK_IMPORTED_MODULE_7___default()(_templateObject9())
            });

          case 8:
            _context4.prev = 8;
            _context4.next = 11;
            return props.client.mutate({
              mutation: graphql_tag__WEBPACK_IMPORTED_MODULE_7___default()(_templateObject10())
            });

          case 11:
            result = _context4.sent;
            _context4.next = 18;
            break;

          case 14:
            _context4.prev = 14;
            _context4.t0 = _context4["catch"](8);
            props.dispatch({
              type: 'ADD_TOAST',
              toast: {
                id: new Date().getTime(),
                name: 'alert',
                text: "Failed to publish the project. See Metro logs for details."
              }
            });
            throw _context4.t0;

          case 18:
            _context4.prev = 18;
            props.dispatch({
              type: 'REMOVE_TOAST',
              id: publishingId
            });
            return _context4.finish(18);

          case 21:
            url = result.data.publishProject.url;
            props.dispatch({
              type: 'ADD_TOAST',
              toast: {
                id: new Date().getTime(),
                name: 'success',
                text: react__WEBPACK_IMPORTED_MODULE_6___default.a.createElement("span", {
                  __source: {
                    fileName: _jsxFileName,
                    lineNumber: 455
                  },
                  __self: this
                }, "Successfully published to", ' ', react__WEBPACK_IMPORTED_MODULE_6___default.a.createElement("a", {
                  target: "_blank",
                  href: url,
                  __source: {
                    fileName: _jsxFileName,
                    lineNumber: 457
                  },
                  __self: this
                }, url), ".")
              }
            });

          case 23:
          case "end":
            return _context4.stop();
        }
      }
    }, _callee4, this, [[8, 14, 18, 21]]);
  }));

  return function publishProject(_x6, _x7) {
    return _ref11.apply(this, arguments);
  };
}();
var UPDATE_LAST_READ = graphql_tag__WEBPACK_IMPORTED_MODULE_7___default()(_templateObject11());
var updateLastRead = /*#__PURE__*/function () {
  var _ref13 = Object(_babel_runtime_corejs2_helpers_esm_asyncToGenerator__WEBPACK_IMPORTED_MODULE_1__["default"])( /*#__PURE__*/_babel_runtime_corejs2_regenerator__WEBPACK_IMPORTED_MODULE_0___default.a.mark(function _callee5(_ref12, props) {
    var sourceId, sourceType, lastReadCursor;
    return _babel_runtime_corejs2_regenerator__WEBPACK_IMPORTED_MODULE_0___default.a.wrap(function _callee5$(_context5) {
      while (1) {
        switch (_context5.prev = _context5.next) {
          case 0:
            sourceId = _ref12.sourceId, sourceType = _ref12.sourceType, lastReadCursor = _ref12.lastReadCursor;
            return _context5.abrupt("return", props.client.mutate({
              mutation: UPDATE_LAST_READ,
              variables: {
                sourceId: sourceId,
                lastReadCursor: lastReadCursor
              },
              optimisticResponse: {
                __typename: 'Mutation',
                updateLastRead: {
                  id: sourceId,
                  __typename: sourceType,
                  messages: {
                    unreadCount: 0,
                    __typename: 'MessageConnection',
                    pageInfo: {
                      __typename: 'PageInfo',
                      lastReadCursor: lastReadCursor
                    }
                  }
                }
              }
            }));

          case 2:
          case "end":
            return _context5.stop();
        }
      }
    }, _callee5);
  }));

  return function updateLastRead(_x8, _x9) {
    return _ref13.apply(this, arguments);
  };
}();
var clearMessages = /*#__PURE__*/function () {
  var _ref15 = Object(_babel_runtime_corejs2_helpers_esm_asyncToGenerator__WEBPACK_IMPORTED_MODULE_1__["default"])( /*#__PURE__*/_babel_runtime_corejs2_regenerator__WEBPACK_IMPORTED_MODULE_0___default.a.mark(function _callee6(_ref14, props) {
    var source;
    return _babel_runtime_corejs2_regenerator__WEBPACK_IMPORTED_MODULE_0___default.a.wrap(function _callee6$(_context6) {
      while (1) {
        switch (_context6.prev = _context6.next) {
          case 0:
            source = _ref14.source;
            return _context6.abrupt("return", props.client.mutate({
              mutation: graphql_tag__WEBPACK_IMPORTED_MODULE_7___default()(_templateObject12()),
              variables: {
                sourceId: source.id
              },
              optimisticResponse: {
                __typename: 'Mutation',
                clearMessages: {
                  __typename: source.__typename,
                  id: source.id,
                  messages: {
                    __typename: 'MessageConnection',
                    count: 0,
                    unreadCount: 0,
                    nodes: []
                  }
                }
              }
            }));

          case 2:
          case "end":
            return _context6.stop();
        }
      }
    }, _callee6);
  }));

  return function clearMessages(_x10, _x11) {
    return _ref15.apply(this, arguments);
  };
}();

/***/ })

})
//# sourceMappingURL=index.js.9dc3e628c8582355370f.hot-update.js.map